{"ast":null,"code":"import attachGeocoding from \"src/decidim/geocoding/attach_input\";\nimport getCoordinateInputName from \"src/decidim/geocoding/coordinate_input\";\n$(function () {\n  var $checkbox = $(\"input:checkbox[name$='[has_address]']\");\n  var $addressInput = $(\"#address_input\");\n  var $addressInputField = $(\"input\", $addressInput);\n  var $map = $(\"#address_map\");\n  var latFieldName = \"latitude\";\n  var longFieldName = \"longitude\";\n  if ($addressInputField.length > 0) {\n    latFieldName = getCoordinateInputName(\"latitude\", $addressInputField, {});\n    longFieldName = getCoordinateInputName(\"longitude\", $addressInputField, {});\n  }\n  $map.hide();\n  if ($checkbox.length > 0) {\n    var toggleInput = function toggleInput() {\n      if ($checkbox[0].checked) {\n        $addressInput.show();\n        $addressInputField.prop(\"disabled\", false);\n      } else {\n        $addressInput.hide();\n        $addressInputField.prop(\"disabled\", true);\n      }\n    };\n    toggleInput();\n    $checkbox.on(\"change\", toggleInput);\n  }\n  if ($addressInput.length > 0) {\n    if ($checkbox[0].checked) {\n      $map.show();\n    }\n    var ctrl = $(\"[data-decidim-map]\").data(\"map-controller\");\n    ctrl.setEventHandler(\"coordinates\", function (ev) {\n      $(\"input[name='\".concat(latFieldName, \"']\")).val(ev.lat);\n      $(\"input[name='\".concat(longFieldName, \"']\")).val(ev.lng);\n    });\n    attachGeocoding($addressInputField, null, function (coordinates) {\n      $map.show();\n      // Remove previous marker when user updates address in address field\n      ctrl.removeMarker();\n      ctrl.addMarker({\n        latitude: coordinates[0],\n        longitude: coordinates[1],\n        address: $addressInput.val()\n      });\n    });\n  }\n});","map":{"version":3,"names":["attachGeocoding","getCoordinateInputName","$","$checkbox","$addressInput","$addressInputField","$map","latFieldName","longFieldName","length","hide","toggleInput","checked","show","prop","on","ctrl","data","setEventHandler","ev","concat","val","lat","lng","coordinates","removeMarker","addMarker","latitude","longitude","address"],"sources":["/home/nico/.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-proposals-0.27.3/app/packs/src/decidim/proposals/add_proposal.js"],"sourcesContent":["import attachGeocoding from \"src/decidim/geocoding/attach_input\"\nimport getCoordinateInputName from \"src/decidim/geocoding/coordinate_input\";\n\n$(() => {\n  const $checkbox = $(\"input:checkbox[name$='[has_address]']\");\n  const $addressInput = $(\"#address_input\");\n  const $addressInputField = $(\"input\", $addressInput);\n  const $map = $(\"#address_map\");\n  let latFieldName = \"latitude\";\n  let longFieldName = \"longitude\";\n\n  if ($addressInputField.length > 0) {\n    latFieldName = getCoordinateInputName(\"latitude\", $addressInputField, {})\n    longFieldName = getCoordinateInputName(\"longitude\", $addressInputField, {})\n  }\n\n  $map.hide();\n\n  if ($checkbox.length > 0) {\n    const toggleInput = () => {\n      if ($checkbox[0].checked) {\n        $addressInput.show();\n        $addressInputField.prop(\"disabled\", false);\n      } else {\n        $addressInput.hide();\n        $addressInputField.prop(\"disabled\", true);\n      }\n    }\n    toggleInput();\n    $checkbox.on(\"change\", toggleInput);\n  }\n\n  if ($addressInput.length > 0) {\n    if ($checkbox[0].checked) {\n      $map.show();\n    }\n\n    const ctrl = $(\"[data-decidim-map]\").data(\"map-controller\");\n    ctrl.setEventHandler(\"coordinates\", (ev) => {\n      $(`input[name='${latFieldName}']`).val(ev.lat);\n      $(`input[name='${longFieldName}']`).val(ev.lng);\n    });\n\n    attachGeocoding($addressInputField, null, (coordinates) => {\n      $map.show();\n      // Remove previous marker when user updates address in address field\n      ctrl.removeMarker();\n      ctrl.addMarker({\n        latitude: coordinates[0],\n        longitude: coordinates[1],\n        address: $addressInput.val()\n      });\n    });\n  }\n});\n"],"mappings":"AAAA,OAAOA,eAAe,MAAM,oCAAoC;AAChE,OAAOC,sBAAsB,MAAM,wCAAwC;AAE3EC,CAAC,CAAC,YAAM;EACN,IAAMC,SAAS,GAAGD,CAAC,CAAC,uCAAuC,CAAC;EAC5D,IAAME,aAAa,GAAGF,CAAC,CAAC,gBAAgB,CAAC;EACzC,IAAMG,kBAAkB,GAAGH,CAAC,CAAC,OAAO,EAAEE,aAAa,CAAC;EACpD,IAAME,IAAI,GAAGJ,CAAC,CAAC,cAAc,CAAC;EAC9B,IAAIK,YAAY,GAAG,UAAU;EAC7B,IAAIC,aAAa,GAAG,WAAW;EAE/B,IAAIH,kBAAkB,CAACI,MAAM,GAAG,CAAC,EAAE;IACjCF,YAAY,GAAGN,sBAAsB,CAAC,UAAU,EAAEI,kBAAkB,EAAE,CAAC,CAAC,CAAC;IACzEG,aAAa,GAAGP,sBAAsB,CAAC,WAAW,EAAEI,kBAAkB,EAAE,CAAC,CAAC,CAAC;EAC7E;EAEAC,IAAI,CAACI,IAAI,CAAC,CAAC;EAEX,IAAIP,SAAS,CAACM,MAAM,GAAG,CAAC,EAAE;IACxB,IAAME,WAAW,GAAG,SAAdA,WAAWA,CAAA,EAAS;MACxB,IAAIR,SAAS,CAAC,CAAC,CAAC,CAACS,OAAO,EAAE;QACxBR,aAAa,CAACS,IAAI,CAAC,CAAC;QACpBR,kBAAkB,CAACS,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC;MAC5C,CAAC,MAAM;QACLV,aAAa,CAACM,IAAI,CAAC,CAAC;QACpBL,kBAAkB,CAACS,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC;MAC3C;IACF,CAAC;IACDH,WAAW,CAAC,CAAC;IACbR,SAAS,CAACY,EAAE,CAAC,QAAQ,EAAEJ,WAAW,CAAC;EACrC;EAEA,IAAIP,aAAa,CAACK,MAAM,GAAG,CAAC,EAAE;IAC5B,IAAIN,SAAS,CAAC,CAAC,CAAC,CAACS,OAAO,EAAE;MACxBN,IAAI,CAACO,IAAI,CAAC,CAAC;IACb;IAEA,IAAMG,IAAI,GAAGd,CAAC,CAAC,oBAAoB,CAAC,CAACe,IAAI,CAAC,gBAAgB,CAAC;IAC3DD,IAAI,CAACE,eAAe,CAAC,aAAa,EAAE,UAACC,EAAE,EAAK;MAC1CjB,CAAC,gBAAAkB,MAAA,CAAgBb,YAAY,OAAI,CAAC,CAACc,GAAG,CAACF,EAAE,CAACG,GAAG,CAAC;MAC9CpB,CAAC,gBAAAkB,MAAA,CAAgBZ,aAAa,OAAI,CAAC,CAACa,GAAG,CAACF,EAAE,CAACI,GAAG,CAAC;IACjD,CAAC,CAAC;IAEFvB,eAAe,CAACK,kBAAkB,EAAE,IAAI,EAAE,UAACmB,WAAW,EAAK;MACzDlB,IAAI,CAACO,IAAI,CAAC,CAAC;MACX;MACAG,IAAI,CAACS,YAAY,CAAC,CAAC;MACnBT,IAAI,CAACU,SAAS,CAAC;QACbC,QAAQ,EAAEH,WAAW,CAAC,CAAC,CAAC;QACxBI,SAAS,EAAEJ,WAAW,CAAC,CAAC,CAAC;QACzBK,OAAO,EAAEzB,aAAa,CAACiB,GAAG,CAAC;MAC7B,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}