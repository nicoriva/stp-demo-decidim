{"ast":null,"code":"function _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i[\"return\"] && (_r = _i[\"return\"](), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n/* eslint-disable require-jsdoc */\n\nimport attributeDiff from \"src/decidim/editor/attribute_diff\";\nexport default function backspaceBindingsRangeAny(quill) {\n  quill.keyboard.addBinding({\n    key: 8,\n    altKey: null,\n    ctrlKey: null,\n    metaKey: null,\n    shiftKey: null,\n    collapsed: true\n  }, function (range, context) {\n    var length = 1;\n    if (range.index === 0 || quill.getLength() <= 1) {\n      return;\n    }\n    var _quill$getLine = quill.getLine(range.index),\n      _quill$getLine2 = _slicedToArray(_quill$getLine, 1),\n      line = _quill$getLine2[0];\n    var formats = {};\n    if (context.offset === 0) {\n      var _quill$getLine3 = quill.getLine(range.index - 1),\n        _quill$getLine4 = _slicedToArray(_quill$getLine3, 1),\n        prev = _quill$getLine4[0];\n      if (prev !== null && prev.length() > 1) {\n        var curFormats = line.formats();\n        var prevFormats = quill.getFormat(range.index - 1, 1);\n        formats = attributeDiff(curFormats, prevFormats) || {};\n        var previousLineLength = quill.getLine(range.index - 1)[1];\n        var previousChar = quill.getText(range.index - 1, 1);\n        var beforePreviousChar = quill.getText(range.index - 2, 1);\n        if (previousLineLength && previousLineLength === 1 && beforePreviousChar === \"\\n\") {\n          if (prevFormats && prevFormats.list) {\n            quill.setSelection(range.index - 2, Quill.sources.SILENT);\n          } else if (previousChar === \"\\n\" && beforePreviousChar === \"\\n\") {\n            length += 1;\n          }\n        }\n      }\n    }\n    if (/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]$/.test(context.prefix)) {\n      length += 1;\n    }\n    quill.deleteText(range.index - length, length, Quill.sources.USER);\n    if (Object.keys(formats).length > 0) {\n      quill.formatLine(range.index - length, length, formats, Quill.sources.USER);\n    }\n    quill.focus();\n  });\n\n  // Put this backspace binding to second (after backspce_offset1 it's going to be third)\n  quill.keyboard.bindings[8].splice(1, 0, quill.keyboard.bindings[8].pop());\n}","map":{"version":3,"names":["attributeDiff","backspaceBindingsRangeAny","quill","keyboard","addBinding","key","altKey","ctrlKey","metaKey","shiftKey","collapsed","range","context","length","index","getLength","_quill$getLine","getLine","_quill$getLine2","_slicedToArray","line","formats","offset","_quill$getLine3","_quill$getLine4","prev","curFormats","prevFormats","getFormat","previousLineLength","previousChar","getText","beforePreviousChar","list","setSelection","Quill","sources","SILENT","test","prefix","deleteText","USER","Object","keys","formatLine","focus","bindings","splice","pop"],"sources":["/home/nico/.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.3/app/packs/src/decidim/editor/modified_backspace_offset_any.js"],"sourcesContent":["/* eslint-disable require-jsdoc */\n\nimport attributeDiff from \"src/decidim/editor/attribute_diff\"\n\nexport default function backspaceBindingsRangeAny(quill) {\n  quill.keyboard.addBinding({ key: 8, altKey: null, ctrlKey: null, metaKey: null, shiftKey: null, collapsed: true }, (range, context) => {\n    let length = 1;\n    if (range.index === 0 || quill.getLength() <= 1) {\n      return;\n    }\n    let [line] = quill.getLine(range.index);\n    let formats = {};\n    if (context.offset === 0) {\n      let [prev] = quill.getLine(range.index - 1);\n      if (prev !== null && prev.length() > 1) {\n        let curFormats = line.formats();\n        let prevFormats = quill.getFormat(range.index - 1, 1);\n        formats = attributeDiff(curFormats, prevFormats) || {};\n        const previousLineLength = quill.getLine(range.index - 1)[1];\n        const previousChar = quill.getText(range.index - 1, 1)\n        const beforePreviousChar = quill.getText(range.index - 2, 1);\n        if (previousLineLength && previousLineLength === 1 && beforePreviousChar === \"\\n\") {\n          if (prevFormats && prevFormats.list) {\n            quill.setSelection(range.index - 2, Quill.sources.SILENT);\n          } else if (previousChar === \"\\n\" && beforePreviousChar === \"\\n\") {\n            length += 1;\n          }\n        }\n      }\n    }\n\n    if ((/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]$/).test(context.prefix)) {\n      length += 1;\n    }\n    quill.deleteText(range.index - length, length, Quill.sources.USER);\n\n    if (Object.keys(formats).length > 0) {\n      quill.formatLine(range.index - length, length, formats, Quill.sources.USER);\n    }\n    quill.focus();\n  })\n\n  // Put this backspace binding to second (after backspce_offset1 it's going to be third)\n  quill.keyboard.bindings[8].splice(1, 0, quill.keyboard.bindings[8].pop());\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}