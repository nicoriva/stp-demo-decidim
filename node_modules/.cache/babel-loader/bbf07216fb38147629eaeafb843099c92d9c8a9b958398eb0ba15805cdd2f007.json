{"ast":null,"code":"import dayjs from \"dayjs\";\n$(function () {\n  var $impersonationWarning = $(\".impersonation-warning\");\n  if ($impersonationWarning.length) {\n    var endsAt = dayjs($impersonationWarning.data(\"session-ends-at\"));\n    var exitInterval = setInterval(function () {\n      var diff = (endsAt - dayjs()) / 60000;\n      var diffInMinutes = Math.round(diff);\n      $impersonationWarning.find(\".minutes\").html(diffInMinutes);\n      if (diff <= 0) {\n        window.location.reload();\n      }\n    }, 1000);\n\n    // Prevent reload when page is already unloading, otherwise it may cause infinite reloads.\n    window.addEventListener(\"beforeunload\", function () {\n      clearInterval(exitInterval);\n      return;\n    });\n  }\n});","map":{"version":3,"names":["dayjs","$","$impersonationWarning","length","endsAt","data","exitInterval","setInterval","diff","diffInMinutes","Math","round","find","html","window","location","reload","addEventListener","clearInterval"],"sources":["/home/nico/.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.3/app/packs/src/decidim/impersonation.js"],"sourcesContent":["import dayjs from \"dayjs\"\n\n$(() => {\n  const $impersonationWarning = $(\".impersonation-warning\");\n  if ($impersonationWarning.length) {\n    const endsAt = dayjs($impersonationWarning.data(\"session-ends-at\"));\n    const exitInterval = setInterval(() => {\n      const diff = (endsAt - dayjs()) / 60000;\n      const diffInMinutes = Math.round(diff);\n      $impersonationWarning.find(\".minutes\").html(diffInMinutes);\n\n      if (diff <= 0) {\n        window.location.reload();\n      }\n    }, 1000);\n\n    // Prevent reload when page is already unloading, otherwise it may cause infinite reloads.\n    window.addEventListener(\"beforeunload\", () => {\n      clearInterval(exitInterval);\n      return;\n    });\n  }\n});\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzBC,CAAC,CAAC,YAAM;EACN,IAAMC,qBAAqB,GAAGD,CAAC,CAAC,wBAAwB,CAAC;EACzD,IAAIC,qBAAqB,CAACC,MAAM,EAAE;IAChC,IAAMC,MAAM,GAAGJ,KAAK,CAACE,qBAAqB,CAACG,IAAI,CAAC,iBAAiB,CAAC,CAAC;IACnE,IAAMC,YAAY,GAAGC,WAAW,CAAC,YAAM;MACrC,IAAMC,IAAI,GAAG,CAACJ,MAAM,GAAGJ,KAAK,CAAC,CAAC,IAAI,KAAK;MACvC,IAAMS,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC;MACtCN,qBAAqB,CAACU,IAAI,CAAC,UAAU,CAAC,CAACC,IAAI,CAACJ,aAAa,CAAC;MAE1D,IAAID,IAAI,IAAI,CAAC,EAAE;QACbM,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC;MAC1B;IACF,CAAC,EAAE,IAAI,CAAC;;IAER;IACAF,MAAM,CAACG,gBAAgB,CAAC,cAAc,EAAE,YAAM;MAC5CC,aAAa,CAACZ,YAAY,CAAC;MAC3B;IACF,CAAC,CAAC;EACJ;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}