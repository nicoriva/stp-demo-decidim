{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}\nfunction _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nvar DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nvar MESSAGES = DEFAULT_MESSAGES;\nvar FormValidator = /*#__PURE__*/function () {\n  function FormValidator(form) {\n    var _this = this;\n    _classCallCheck(this, FormValidator);\n    this.$form = form;\n    this.$form.on(\"form-error.decidim\", function () {\n      _this.handleError();\n    });\n  }\n  _createClass(FormValidator, [{\n    key: \"handleError\",\n    value: function handleError() {\n      this.announceFormError();\n      $(\".is-invalid-input:first\", this.$form).focus();\n    }\n\n    /**\n     * This announces immediately to the screen reader that there are errors on\n     * the form that need to be fixed. Does not work on all screen readers but\n     * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n     * combinations.\n     *\n     * @returns {undefined}\n     */\n  }, {\n    key: \"announceFormError\",\n    value: function announceFormError() {\n      var $announce = $(\".sr-announce\", this.$form);\n      if ($announce.length > 0) {\n        $announce.remove();\n      }\n      $announce = $(\"<div />\");\n      $announce.attr(\"class\", \"sr-announce show-for-sr\");\n      $announce.attr(\"aria-live\", \"assertive\");\n      this.$form.prepend($announce);\n      setTimeout(function () {\n        $announce.text(MESSAGES.correctErrors);\n      }, 100);\n    }\n  }], [{\n    key: \"configureMessages\",\n    value: function configureMessages(messages) {\n      MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n    }\n  }]);\n  return FormValidator;\n}();\nexport { FormValidator as default };\n$(function () {\n  $(\"form\").each(function (_i, el) {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function (_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  });\n});","map":{"version":3,"names":["DEFAULT_MESSAGES","correctErrors","MESSAGES","FormValidator","form","_this","_classCallCheck","$form","on","handleError","_createClass","key","value","announceFormError","$","focus","$announce","length","remove","attr","prepend","setTimeout","text","configureMessages","messages","extend","default","each","_i","el","data","document","_ev","trigger"],"sources":["/home/nico/.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.3/app/packs/src/decidim/form_validator.js"],"sourcesContent":["const DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nlet MESSAGES = DEFAULT_MESSAGES;\n\nexport default class FormValidator {\n  static configureMessages(messages) {\n    MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n  }\n\n  constructor(form) {\n    this.$form = form;\n\n    this.$form.on(\"form-error.decidim\", () => {\n      this.handleError();\n    });\n  }\n\n  handleError() {\n    this.announceFormError();\n\n    $(\".is-invalid-input:first\", this.$form).focus();\n  }\n\n  /**\n   * This announces immediately to the screen reader that there are errors on\n   * the form that need to be fixed. Does not work on all screen readers but\n   * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n   * combinations.\n   *\n   * @returns {undefined}\n   */\n  announceFormError() {\n    let $announce = $(\".sr-announce\", this.$form);\n    if ($announce.length > 0) {\n      $announce.remove();\n    }\n    $announce = $(\"<div />\");\n    $announce.attr(\"class\", \"sr-announce show-for-sr\");\n    $announce.attr(\"aria-live\", \"assertive\");\n    this.$form.prepend($announce);\n\n    setTimeout(() => {\n      $announce.text(MESSAGES.correctErrors);\n    }, 100);\n  }\n}\n\n$(() => {\n  $(\"form\").each((_i, el) => {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function(_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  })\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,gBAAgB,GAAG;EACvBC,aAAa,EAAE;AACjB,CAAC;AACD,IAAIC,QAAQ,GAAGF,gBAAgB;AAAC,IAEXG,aAAa;EAKhC,SAAAA,cAAYC,IAAI,EAAE;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAH,aAAA;IAChB,IAAI,CAACI,KAAK,GAAGH,IAAI;IAEjB,IAAI,CAACG,KAAK,CAACC,EAAE,CAAC,oBAAoB,EAAE,YAAM;MACxCH,KAAI,CAACI,WAAW,CAAC,CAAC;IACpB,CAAC,CAAC;EACJ;EAACC,YAAA,CAAAP,aAAA;IAAAQ,GAAA;IAAAC,KAAA,EAED,SAAAH,YAAA,EAAc;MACZ,IAAI,CAACI,iBAAiB,CAAC,CAAC;MAExBC,CAAC,CAAC,yBAAyB,EAAE,IAAI,CAACP,KAAK,CAAC,CAACQ,KAAK,CAAC,CAAC;IAClD;;IAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EAPE;IAAAJ,GAAA;IAAAC,KAAA,EAQA,SAAAC,kBAAA,EAAoB;MAClB,IAAIG,SAAS,GAAGF,CAAC,CAAC,cAAc,EAAE,IAAI,CAACP,KAAK,CAAC;MAC7C,IAAIS,SAAS,CAACC,MAAM,GAAG,CAAC,EAAE;QACxBD,SAAS,CAACE,MAAM,CAAC,CAAC;MACpB;MACAF,SAAS,GAAGF,CAAC,CAAC,SAAS,CAAC;MACxBE,SAAS,CAACG,IAAI,CAAC,OAAO,EAAE,yBAAyB,CAAC;MAClDH,SAAS,CAACG,IAAI,CAAC,WAAW,EAAE,WAAW,CAAC;MACxC,IAAI,CAACZ,KAAK,CAACa,OAAO,CAACJ,SAAS,CAAC;MAE7BK,UAAU,CAAC,YAAM;QACfL,SAAS,CAACM,IAAI,CAACpB,QAAQ,CAACD,aAAa,CAAC;MACxC,CAAC,EAAE,GAAG,CAAC;IACT;EAAC;IAAAU,GAAA;IAAAC,KAAA,EAvCD,SAAAW,kBAAyBC,QAAQ,EAAE;MACjCtB,QAAQ,GAAGY,CAAC,CAACW,MAAM,CAACzB,gBAAgB,EAAEwB,QAAQ,CAAC;IACjD;EAAC;EAAA,OAAArB,aAAA;AAAA;AAAA,SAHkBA,aAAa,IAAAuB,OAAA;AA2ClCZ,CAAC,CAAC,YAAM;EACNA,CAAC,CAAC,MAAM,CAAC,CAACa,IAAI,CAAC,UAACC,EAAE,EAAEC,EAAE,EAAK;IACzBf,CAAC,CAACe,EAAE,CAAC,CAACC,IAAI,CAAC,gBAAgB,EAAE,IAAI3B,aAAa,CAACW,CAAC,CAACe,EAAE,CAAC,CAAC,CAAC;EACxD,CAAC,CAAC;EACFf,CAAC,CAACiB,QAAQ,CAAC,CAACvB,EAAE,CAAC,sBAAsB,EAAE,UAASwB,GAAG,EAAE5B,IAAI,EAAE;IACzDA,IAAI,CAAC6B,OAAO,CAAC,oBAAoB,CAAC;EACpC,CAAC,CAAC;AACJ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}